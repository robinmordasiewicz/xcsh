{"openapi":"3.0.0","info":{"title":"F5 Distributed Cloud Services API for ves.io.schema.waf","description":"APIs to get monitoring information about WAF instances on virtual-host basis. \nIt gets data for a given virtual host based on any WAF instance attached to virtual host or route used by virtual host.","version":""},"paths":{"/api/data/namespaces/{namespace}/wafs/metrics/client/rule_hits":{"post":{"summary":"Client Rule Hits Metrics","description":"Get number of rule hits per client for a given namespace.\nThe rule hits counter can be aggregated based on one or more labels listed here.\nNAMESPACE, APP_TYPE, VIRTUAL_HOST, SITE, SERVICE, INSTANCE, WAF_INSTANCE_ID, RULE_ID, RULE_SEVERITY, RULE_TAG.","operationId":"ves.io.schema.waf.WAFMonitoringAPI.ClientRuleHitsMetrics","responses":{"200":{"description":"A successful response.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafRuleHitsCountResponse"}}}},"401":{"description":"Returned when operation is not authorized","content":{"application/json":{"schema":{"format":"string"}}}},"403":{"description":"Returned when there is no permission to access resource","content":{"application/json":{"schema":{"format":"string"}}}},"404":{"description":"Returned when resource is not found","content":{"application/json":{"schema":{"format":"string"}}}},"409":{"description":"Returned when operation on resource is conflicting with current value","content":{"application/json":{"schema":{"format":"string"}}}},"429":{"description":"Returned when operation has been rejected as it is happening too frequently","content":{"application/json":{"schema":{"format":"string"}}}},"500":{"description":"Returned when server encountered an error in processing API","content":{"application/json":{"schema":{"format":"string"}}}},"503":{"description":"Returned when service is unavailable temporarily","content":{"application/json":{"schema":{"format":"string"}}}},"504":{"description":"Returned when server timed out processing request","content":{"application/json":{"schema":{"format":"string"}}}}},"parameters":[{"name":"namespace","description":"Namespace\n\nnamespace is used to scope the WAF rule hits for the given namespace.\nx-example: \"bloggin-app-namespace-1\"","in":"path","required":true,"x-displayname":"Namespace","schema":{"type":"string"}}],"requestBody":{"$ref":"#/components/requestBodies/wafRuleHitsCountRequest"},"externalDocs":{"description":"Examples of this operation","url":"https://docs.cloud.f5.com/docs-v2/platform/reference/api-ref/ves-io-schema-waf-wafmonitoringapi-clientrulehitsmetrics"},"x-ves-proto-rpc":"ves.io.schema.waf.WAFMonitoringAPI.ClientRuleHitsMetrics"},"x-displayname":"WAF","x-ves-proto-service":"ves.io.schema.waf.WAFMonitoringAPI","x-ves-proto-service-type":"CUSTOM_PUBLIC"},"/api/data/namespaces/{namespace}/wafs/metrics/client/security_events":{"post":{"summary":"Client Security Events Metrics","description":"Get number of security events per client for a given namespace.\nThe security events counter can be aggregated based on one or more labels listed here.\nNAMESPACE, APP_TYPE, VIRTUAL_HOST, SITE, SERVICE, INSTANCE, WAF_INSTANCE_ID, WAF_MODE.","operationId":"ves.io.schema.waf.WAFMonitoringAPI.ClientSecurityEventsMetrics","responses":{"200":{"description":"A successful response.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafSecurityEventsCountResponse"}}}},"401":{"description":"Returned when operation is not authorized","content":{"application/json":{"schema":{"format":"string"}}}},"403":{"description":"Returned when there is no permission to access resource","content":{"application/json":{"schema":{"format":"string"}}}},"404":{"description":"Returned when resource is not found","content":{"application/json":{"schema":{"format":"string"}}}},"409":{"description":"Returned when operation on resource is conflicting with current value","content":{"application/json":{"schema":{"format":"string"}}}},"429":{"description":"Returned when operation has been rejected as it is happening too frequently","content":{"application/json":{"schema":{"format":"string"}}}},"500":{"description":"Returned when server encountered an error in processing API","content":{"application/json":{"schema":{"format":"string"}}}},"503":{"description":"Returned when service is unavailable temporarily","content":{"application/json":{"schema":{"format":"string"}}}},"504":{"description":"Returned when server timed out processing request","content":{"application/json":{"schema":{"format":"string"}}}}},"parameters":[{"name":"namespace","description":"Namespace\n\nx-example: \"bloggin-app-namespace-1\"\nnamespace is used to scope the WAF security events for the given namespace.","in":"path","required":true,"x-displayname":"Namespace","schema":{"type":"string"}}],"requestBody":{"$ref":"#/components/requestBodies/wafSecurityEventsCountRequest"},"externalDocs":{"description":"Examples of this operation","url":"https://docs.cloud.f5.com/docs-v2/platform/reference/api-ref/ves-io-schema-waf-wafmonitoringapi-clientsecurityeventsmetrics"},"x-ves-proto-rpc":"ves.io.schema.waf.WAFMonitoringAPI.ClientSecurityEventsMetrics"},"x-displayname":"WAF","x-ves-proto-service":"ves.io.schema.waf.WAFMonitoringAPI","x-ves-proto-service-type":"CUSTOM_PUBLIC"},"/api/data/namespaces/{namespace}/wafs/metrics/server/rule_hits":{"post":{"summary":"Server Rule Hits Metrics","description":"Get number of rule hits per server for a given namespace.\nThe rule hits counter can be aggregated based on one or more labels listed here.\nNAMESPACE, APP_TYPE, VIRTUAL_HOST, SITE, SERVICE, INSTANCE, WAF_INSTANCE_ID, RULE_ID, RULE_SEVERITY, RULE_TAG.","operationId":"ves.io.schema.waf.WAFMonitoringAPI.ServerRuleHitsMetrics","responses":{"200":{"description":"A successful response.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafRuleHitsCountResponse"}}}},"401":{"description":"Returned when operation is not authorized","content":{"application/json":{"schema":{"format":"string"}}}},"403":{"description":"Returned when there is no permission to access resource","content":{"application/json":{"schema":{"format":"string"}}}},"404":{"description":"Returned when resource is not found","content":{"application/json":{"schema":{"format":"string"}}}},"409":{"description":"Returned when operation on resource is conflicting with current value","content":{"application/json":{"schema":{"format":"string"}}}},"429":{"description":"Returned when operation has been rejected as it is happening too frequently","content":{"application/json":{"schema":{"format":"string"}}}},"500":{"description":"Returned when server encountered an error in processing API","content":{"application/json":{"schema":{"format":"string"}}}},"503":{"description":"Returned when service is unavailable temporarily","content":{"application/json":{"schema":{"format":"string"}}}},"504":{"description":"Returned when server timed out processing request","content":{"application/json":{"schema":{"format":"string"}}}}},"parameters":[{"name":"namespace","description":"Namespace\n\nnamespace is used to scope the WAF rule hits for the given namespace.\nx-example: \"bloggin-app-namespace-1\"","in":"path","required":true,"x-displayname":"Namespace","schema":{"type":"string"}}],"requestBody":{"$ref":"#/components/requestBodies/wafRuleHitsCountRequest"},"externalDocs":{"description":"Examples of this operation","url":"https://docs.cloud.f5.com/docs-v2/platform/reference/api-ref/ves-io-schema-waf-wafmonitoringapi-serverrulehitsmetrics"},"x-ves-proto-rpc":"ves.io.schema.waf.WAFMonitoringAPI.ServerRuleHitsMetrics"},"x-displayname":"WAF","x-ves-proto-service":"ves.io.schema.waf.WAFMonitoringAPI","x-ves-proto-service-type":"CUSTOM_PUBLIC"},"/api/data/namespaces/{namespace}/wafs/metrics/server/security_events":{"post":{"summary":"Server Security Events Metrics","description":"Get number of security events per server for a given namespace.\nThe security events counter can be aggregated based on one or more labels listed here.\nNAMESPACE, APP_TYPE, VIRTUAL_HOST, SITE, SERVICE, INSTANCE, WAF_INSTANCE_ID, WAF_MODE.","operationId":"ves.io.schema.waf.WAFMonitoringAPI.ServerSecurityEventsMetrics","responses":{"200":{"description":"A successful response.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafSecurityEventsCountResponse"}}}},"401":{"description":"Returned when operation is not authorized","content":{"application/json":{"schema":{"format":"string"}}}},"403":{"description":"Returned when there is no permission to access resource","content":{"application/json":{"schema":{"format":"string"}}}},"404":{"description":"Returned when resource is not found","content":{"application/json":{"schema":{"format":"string"}}}},"409":{"description":"Returned when operation on resource is conflicting with current value","content":{"application/json":{"schema":{"format":"string"}}}},"429":{"description":"Returned when operation has been rejected as it is happening too frequently","content":{"application/json":{"schema":{"format":"string"}}}},"500":{"description":"Returned when server encountered an error in processing API","content":{"application/json":{"schema":{"format":"string"}}}},"503":{"description":"Returned when service is unavailable temporarily","content":{"application/json":{"schema":{"format":"string"}}}},"504":{"description":"Returned when server timed out processing request","content":{"application/json":{"schema":{"format":"string"}}}}},"parameters":[{"name":"namespace","description":"Namespace\n\nx-example: \"bloggin-app-namespace-1\"\nnamespace is used to scope the WAF security events for the given namespace.","in":"path","required":true,"x-displayname":"Namespace","schema":{"type":"string"}}],"requestBody":{"$ref":"#/components/requestBodies/wafSecurityEventsCountRequest"},"externalDocs":{"description":"Examples of this operation","url":"https://docs.cloud.f5.com/docs-v2/platform/reference/api-ref/ves-io-schema-waf-wafmonitoringapi-serversecurityeventsmetrics"},"x-ves-proto-rpc":"ves.io.schema.waf.WAFMonitoringAPI.ServerSecurityEventsMetrics"},"x-displayname":"WAF","x-ves-proto-service":"ves.io.schema.waf.WAFMonitoringAPI","x-ves-proto-service-type":"CUSTOM_PUBLIC"}},"x-displayname":"WAF","x-ves-proto-package":"ves.io.schema.waf","components":{"requestBodies":{"wafSecurityEventsCountRequest":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafSecurityEventsCountRequest"}}},"required":true},"wafRuleHitsCountRequest":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/wafRuleHitsCountRequest"}}},"required":true}},"schemas":{"schemaMetricValue":{"type":"object","description":"Metric data contains timestamp and the value.","title":"Metric Value","x-displayname":"Metric Value","x-ves-proto-message":"ves.io.schema.MetricValue","properties":{"timestamp":{"type":"number","description":" timestamp\n\nExample: ` \"1570007981\"`","title":"Timestamp","format":"double","x-displayname":"Timestamp","x-ves-example":"1570007981"},"trend_value":{"$ref":"#/components/schemas/schemaTrendValue"},"value":{"type":"string","description":"\n\nExample: ` \"15\"`","title":"Value","x-displayname":"Value","x-ves-example":"15"}}},"schemaTrendSentiment":{"type":"string","description":"trend sentiment\n\nIndicates trend sentiment is positive\nIndicates trend sentiment is negative.","title":"Trend Sentiment","enum":["TREND_SENTIMENT_NONE","TREND_SENTIMENT_POSITIVE","TREND_SENTIMENT_NEGATIVE"],"default":"TREND_SENTIMENT_NONE","x-displayname":"Trend Sentiment","x-ves-proto-enum":"ves.io.schema.TrendSentiment"},"schemaTrendValue":{"type":"object","description":"Trend value contains trend value, trend sentiment and trend calculation description and window size.","title":"Trend Value","x-displayname":"Trend Value","x-ves-proto-message":"ves.io.schema.TrendValue","properties":{"description":{"type":"string","description":" description of the method used to calculate trend.\n\nExample: ` \"Trend was calculated by comparing the avg of window size intervals of end-start Time and last window time interval\"`","title":"Description","x-displayname":"Description","x-ves-example":"Trend was calculated by comparing the avg of window size intervals of end-start Time and last window time interval"},"previous_value":{"type":"string","description":"\n\nExample: ` \"200.00\"`","title":"Previous Value","x-displayname":"Previous Value","x-ves-example":"200.00"},"sentiment":{"$ref":"#/components/schemas/schemaTrendSentiment"},"value":{"type":"string","description":"\n\nExample: ` \"-15\"`","title":"Value","x-displayname":"Value","x-ves-example":"-15"}}},"schemawafMetricLabelOp":{"type":"string","description":"The operator to use when querying WAF metrics with labels.\nQuery can choose to either select a label if it matches a given value OR\nif it done not match a given value. This is done by choosing the EQ or NEQ operator\nin MetricLabelFilter\n\nEqual to\nNot Equal to","title":"WAF Metric Label Operator","enum":["EQ","NEQ"],"default":"EQ","x-displayname":"WAF Metric Label Operator","x-ves-proto-enum":"ves.io.schema.waf.MetricLabelOp"},"wafMetricLabel":{"type":"string","description":"Labels in the WAF metrics.\n\nRule hits counter and the security events counter can be sliced and diced based\non one or more labels listed below.\n\nNamespace in which this WAF instance is running\nAppType configured on the virtual_host under which this WAF instance is running\nVirtual host under which this WAF instance is running\nSite from which this WAF instance is reporting the metrics\nService for which this WAF instance is reporting the metrics\nRegion from which the client's accesses caused WAF metrics to be generated\nWAF instance ID\nRuleID of the rule that was hit to cause this metric to be generated\nRule severity of the rule that was hit to cause this metric to be generated\nRule tag of the rule that was hit to cause this metric to be generated\nBlock or AlertOnly\nType of the Bot (crawler, scanner, script)\nName of the Bot associated with the waf rule","enum":["NAMESPACE","APP_TYPE","VIRTUAL_HOST","SITE","SERVICE","INSTANCE","WAF_INSTANCE_ID","RULE_ID","RULE_SEVERITY","RULE_TAG","WAF_MODE","BOT_TYPE","BOT_NAME"],"default":"NAMESPACE","x-displayname":"WAF Metric Label","x-ves-proto-enum":"ves.io.schema.waf.MetricLabel"},"wafMetricLabelFilter":{"type":"object","description":"Label based filtering of WAF metrics.\n\nWAF metrics are tagged with labels mentioned in MetricLabel.\nMetric label filter can be specified to query specific metrics based on label match","x-displayname":"WAF Metric Label Filter","x-ves-proto-message":"ves.io.schema.waf.MetricLabelFilter","properties":{"label":{"$ref":"#/components/schemas/wafMetricLabel"},"op":{"$ref":"#/components/schemas/schemawafMetricLabelOp"},"value":{"type":"string","description":" Value to be compared with\n\nExample: ` \"blogging-app-namespace-1\"`","title":"Value","x-displayname":"Value","x-ves-example":"blogging-app-namespace-1"}}},"wafRuleHitsCountRequest":{"type":"object","description":"Request to get number of rule hits per client/server for a given namespace.","title":"RuleHitsCountRequest","x-displayname":"Rule Hits Count Request","x-ves-proto-message":"ves.io.schema.waf.RuleHitsCountRequest","properties":{"end_time":{"type":"string","description":" end time of metric collection from which data will be considered.\n Format: unix_timestamp|rfc 3339\n\n Optional: If not specified, then the end_time will be evaluated to start_time+10m\n           If start_time is not specified, then the end_time will be evaluated to <current time>\n\nExample: ` \"1570007981\"`\n\nValidation Rules:\n  ves.io.schema.rules.string.query_time: true\n","title":"End time","x-displayname":"End Time","x-ves-example":"1570007981","x-ves-validation-rules":{"ves.io.schema.rules.string.query_time":"true"}},"group_by":{"type":"array","description":" Aggregate data by one of more labels listed here.\n NAMESPACE, APP_TYPE, VIRTUAL_HOST, SITE, SERVICE, INSTANCE, WAF_INSTANCE_ID, RULE_ID, RULE_SEVERITY, RULE_TAG.\n\n Optional: If not specified, then the rule hits are aggregated/grouped by VIRTUAL_HOST.","title":"Group by","items":{"$ref":"#/components/schemas/wafMetricLabel"},"x-displayname":"Group By"},"label_filter":{"type":"array","description":" List of label filter expressions of the form \"label\" Op \"value\".\n Response will only contain data that matches all the conditions specified in the label_filter.\n One or more of the following labels can be specified in the label_filter.\n APP_TYPE, VIRTUAL_HOST, SITE, SERVICE, INSTANCE, WAF_INSTANCE_ID, RULE_ID, RULE_SEVERITY, RULE_TAG.\n\n Optional: If not specified, then the metrics will be filtered only based on the namespace in the request.","title":"Label Filter","items":{"$ref":"#/components/schemas/wafMetricLabelFilter"},"x-displayname":"Label Filter"},"namespace":{"type":"string","description":" namespace is used to scope the WAF rule hits for the given namespace.\n\nExample: ` \"bloggin-app-namespace-1\"`","title":"Namespace","x-displayname":"Namespace","x-ves-example":"bloggin-app-namespace-1"},"range":{"type":"string","description":" range decides how far to go back in time to fetch values for each step.\n For example, if the range is 5m, then for step t1, query will be evaluated for t1-5m and for\n t2, query will be evaluated for t2-5m and so on.\n Format: [0-9][smhd], where s - seconds, m - minutes, h - hours, d - days\n\n Note: For non-timeseries query, i.e., for step=end_time-start_time, range should be set to end_time-start_time\n\n Optional: If not specified, range is set to 5m\n\nExample: ` \"50m\"`\n\nValidation Rules:\n  ves.io.schema.rules.string.time_interval: true\n","title":"Range","x-displayname":"Range","x-ves-example":"50m","x-ves-validation-rules":{"ves.io.schema.rules.string.time_interval":"true"}},"start_time":{"type":"string","description":" start time of metric collection from which data will be considered.\n Format: unix_timestamp|rfc 3339\n\n Optional: If not specified, then the start_time will be evaluated to end_time-10m\n           If end_time is not specified, then the start_time will be evaluated to <current time>-10m\n\nExample: ` \"1570007981\"`\n\nValidation Rules:\n  ves.io.schema.rules.string.query_time: true\n","title":"Start time","x-displayname":"Start Time","x-ves-example":"1570007981","x-ves-validation-rules":{"ves.io.schema.rules.string.query_time":"true"}},"step":{"type":"string","description":" step is the resolution width, which determines the number of the data points [x-axis (time)] to be returned in the response.\n The timestamps in the response will be t1=start_time, t2=t1+step, ... tn=tn-1+step, where tn <= end_time.\n Format: [0-9][smhd], where s - seconds, m - minutes, h - hours, d - days\n\n Optional: If not specified, then step size is evaluated to <end_time - start_time>\n\nExample: ` \"5m\"`\n\nValidation Rules:\n  ves.io.schema.rules.string.query_step: true\n","title":"Step","x-displayname":"Step","x-ves-example":"5m","x-ves-validation-rules":{"ves.io.schema.rules.string.query_step":"true"}}}},"wafRuleHitsCountResponse":{"type":"object","description":"Number of rule hits for each unique combination of group_by labels in the RuleHitsCountRequest.","title":"RuleHitsCountResponse","x-displayname":"Rule Hits Count Response","x-ves-proto-message":"ves.io.schema.waf.RuleHitsCountResponse","properties":{"data":{"type":"array","description":" List of rule hits counter data","title":"Rule hits counter","items":{"$ref":"#/components/schemas/wafRuleHitsCounter"},"x-displayname":"Rule hits counter"},"step":{"type":"string","description":" Actual step size used in the response. It could be higher than the requested step due to metric rollups and the query duration.\n Format: [0-9][smhd], where s - seconds, m - minutes, h - hours, d - days\n\nExample: ` \"30m\"`\n\nValidation Rules:\n  ves.io.schema.rules.string.time_interval: true\n","title":"step","x-displayname":"Step","x-ves-example":"30m","x-ves-validation-rules":{"ves.io.schema.rules.string.time_interval":"true"}}}},"wafRuleHitsCounter":{"type":"object","description":"RuleHitsCounter contains the timeseries data of rule hits counter.","title":"Rule Hits Counter","x-displayname":"Rule Hits Counter","x-ves-proto-message":"ves.io.schema.waf.RuleHitsCounter","properties":{"id":{"$ref":"#/components/schemas/wafRuleHitsId"},"metric":{"type":"array","description":" List of metric values","title":"Metric Values","items":{"$ref":"#/components/schemas/schemaMetricValue"},"x-displayname":"Metric Values"}}},"wafRuleHitsId":{"type":"object","description":"RuleHitsId uniquely identifies an entry in the response for rule_hits metrics query.\nRule hits counter is aggregated based on the MetricLabel specified in the group_by field in the request.\nTherefore, only the fields that corresponds to the MetricLabel in the group_by will have non-empty\nvalue in the response.","title":"RuleHitsId","x-displayname":"Rule Hits ID","x-ves-proto-message":"ves.io.schema.waf.RuleHitsId","properties":{"app_type":{"type":"string","description":" AppType configured on the virtual_host under which this WAF instance is running\n\nExample: ` \"blogging-app\"`","title":"AppType","x-displayname":"AppType","x-ves-example":"blogging-app"},"bot_name":{"type":"string","description":" Name of the Bot associated with the waf rule\n\nExample: ` \"whatweb\"`","title":"Bot Name","x-displayname":"Bot Name","x-ves-example":"whatweb"},"bot_type":{"type":"string","description":" Type of Bot (crawler, scanner, script)\n\nExample: ` \"scanner\"`","title":"Bot Type","x-displayname":"Bot Type","x-ves-example":"scanner"},"instance":{"type":"string","description":" Region from which the client's accesses caused WAF metrics to be generated\n\nExample: ` \"India\"`","title":"Instance","x-displayname":"Instance","x-ves-example":"India"},"namespace":{"type":"string","description":" Namespace in which this WAF instance is running\n\nExample: ` \"blogging-app-namespace-1\"`","title":"Namespace","x-displayname":"Namespace","x-ves-example":"blogging-app-namespace-1"},"rule_id":{"type":"string","description":" RuleID of the rule that was hit to cause this metric to be generated\n\nExample: ` \"941210\"`","title":"Rule ID","x-displayname":"Rule ID","x-ves-example":"941210"},"rule_severity":{"type":"string","description":" Rule severity of the rule that was hit to cause this metric to be generated\n\nExample: ` \"CRITICAL\"`","title":"Rule Severity","x-displayname":"Rule Severity","x-ves-example":"CRITICAL"},"rule_tag":{"type":"string","description":" Rule tag of the rule that was hit to cause this metric to be generated\n\nExample: ` \"CAPEC-272\"`","title":"Rule Tag","x-displayname":"Rule Tag","x-ves-example":"CAPEC-272"},"service":{"type":"string","description":" Service for which this WAF instance is reporting the metrics\n\nExample: ` \"N:greatblogs-ce\"`","title":"Service","x-displayname":"Service","x-ves-example":"N:greatblogs-ce"},"site":{"type":"string","description":" Site from which this WAF instance is reporting the metrics\n\nExample: ` \"greatblogs-ce\"`","title":"Site","x-displayname":"Site","x-ves-example":"greatblogs-ce"},"virtual_host":{"type":"string","description":" Virtual host under which this WAF instance is running\n\nExample: ` \"VS:greatblogs-vhost\"`","title":"Virtual Host","x-displayname":"Virtual Host","x-ves-example":"VS:greatblogs-vhost"},"waf_instance_id":{"type":"string","description":" WAF instance ID\n\nExample: ` \"blogging-app-namespace-1:generated-waf-rules-greatblogs-waf\"`","title":"WAF Instance ID","x-displayname":"WAF Instance ID","x-ves-example":"blogging-app-namespace-1:generated-waf-rules-greatblogs-waf"}}},"wafSecurityEventsCountRequest":{"type":"object","description":"Request to get number of security events per client/server for a given namespace.","title":"SecurityEventsCountRequest","x-displayname":"Security Events Count Request","x-ves-proto-message":"ves.io.schema.waf.SecurityEventsCountRequest","properties":{"end_time":{"type":"string","description":" end time of metric collection from which data will be considered.\n Format: unix_timestamp|rfc 3339\n\n Optional: If not specified, then the end_time will be evaluated to start_time+10m\n           If start_time is not specified, then the end_time will be evaluated to <current time>\n\nExample: ` \"1570007981\"`\n\nValidation Rules:\n  ves.io.schema.rules.string.query_time: true\n","title":"End time","x-displayname":"End Time","x-ves-example":"1570007981","x-ves-validation-rules":{"ves.io.schema.rules.string.query_time":"true"}},"group_by":{"type":"array","description":" Aggregate data by one or more labels listed here.\n NAMESPACE, APP_TYPE, VIRTUAL_HOST, SITE, SERVICE, INSTANCE, WAF_INSTANCE_ID, WAF_MODE.\n\n Optional: If not specified, then the rule hits are aggregated/grouped by VIRTUAL_HOST.","title":"Group by","items":{"$ref":"#/components/schemas/wafMetricLabel"},"x-displayname":"Group By"},"label_filter":{"type":"array","description":" List of label filter expressions of the form \"label\" Op \"value\".\n Response will only contain data that matches all the conditions specified in the label_filter.\n One or more of the following labels can be specified in the label_filter.\n APP_TYPE, VIRTUAL_HOST, SITE, SERVICE, INSTANCE, WAF_INSTANCE_ID, WAF_MODE.\n\n Optional: If not specified, then the metrics will be filtered only based on the namespace in the request.","title":"Label Filter","items":{"$ref":"#/components/schemas/wafMetricLabelFilter"},"x-displayname":"Label Filter"},"namespace":{"type":"string","description":" namespace is used to scope the WAF security events for the given namespace.\n\nExample: ` \"bloggin-app-namespace-1\"`","title":"Namespace","x-displayname":"Namespace","x-ves-example":"bloggin-app-namespace-1"},"range":{"type":"string","description":" range decides how far to go back in time to fetch values for each step.\n For example, if the range is 5m, then for step t1, query will be evaluated for t1-5m and for\n t2, query will be evaluated for t2-5m and so on.\n Format: [0-9][smhd], where s - seconds, m - minutes, h - hours, d - days\n\n Note: For non-timeseries query, i.e., for step=end_time-start_time, range should be set to end_time-start_time\n\n Optional: If not specified, range is set to 5m\n\nExample: ` \"45m\"`\n\nValidation Rules:\n  ves.io.schema.rules.string.time_interval: true\n","title":"Range","x-displayname":"Range","x-ves-example":"45m","x-ves-validation-rules":{"ves.io.schema.rules.string.time_interval":"true"}},"start_time":{"type":"string","description":" start time of metric collection from which data will be considered.\n Format: unix_timestamp|rfc 3339\n\n Optional: If not specified, then the start_time will be evaluated to end_time-10m\n           If end_time is not specified, then the start_time will be evaluated to <current time>-10m\n\nExample: ` \"1570007981\"`\n\nValidation Rules:\n  ves.io.schema.rules.string.query_time: true\n","title":"Start time","x-displayname":"Start Time","x-ves-example":"1570007981","x-ves-validation-rules":{"ves.io.schema.rules.string.query_time":"true"}},"step":{"type":"string","description":" step is the resolution width, which determines the number of the data points [x-axis (time)] to be returned in the response.\n The timestamps in the response will be t1=start_time, t2=t1+step, ... tn=tn-1+step, where tn <= end_time.\n Format: [0-9][smhd], where s - seconds, m - minutes, h - hours, d - days\n\n Optional: If not specified, then step size is evaluated to <end_time - start_time>\n\nExample: ` \"15m\"`\n\nValidation Rules:\n  ves.io.schema.rules.string.query_step: true\n","title":"Step","x-displayname":"Step","x-ves-example":"15m","x-ves-validation-rules":{"ves.io.schema.rules.string.query_step":"true"}}}},"wafSecurityEventsCountResponse":{"type":"object","description":"Number of security events for each unique combination of group_by labels in the SecurityEventsCountRequest.","title":"SecurityEventsCountResponse","x-displayname":"Security Events Count Response","x-ves-proto-message":"ves.io.schema.waf.SecurityEventsCountResponse","properties":{"data":{"type":"array","description":" List of security events counter data","title":"Security events counter data","items":{"$ref":"#/components/schemas/wafSecurityEventsCounter"},"x-displayname":"Security events counter data"},"step":{"type":"string","description":" Actual step size used in the response. It could be higher than the requested step due to metric rollups and the query duration.\n Format: [0-9][smhd], where s - seconds, m - minutes, h - hours, d - days\n\nExample: ` \"30m\"`\n\nValidation Rules:\n  ves.io.schema.rules.string.time_interval: true\n","title":"step","x-displayname":"Step","x-ves-example":"30m","x-ves-validation-rules":{"ves.io.schema.rules.string.time_interval":"true"}}}},"wafSecurityEventsCounter":{"type":"object","description":"SecurityEventsCounter contains the timeseries data of security events counter.","title":"Security Events Counter","x-displayname":"Security Events Counter","x-ves-proto-message":"ves.io.schema.waf.SecurityEventsCounter","properties":{"id":{"$ref":"#/components/schemas/wafSecurityEventsId"},"metric":{"type":"array","description":" List of metric values","title":"Metric Values","items":{"$ref":"#/components/schemas/schemaMetricValue"},"x-displayname":"Metric Values"}}},"wafSecurityEventsId":{"type":"object","description":"SecurityEventsId uniquely identifies an entry in the response for rule_hits metrics query.\nsecurity events counter is aggregated based on the MetricLabel specified in the group_by field in the request.\nTherefore, only the fields that corresponds to the MetricLabel in the group_by will have non-empty\nvalue in the response.","title":"SecurityEventsId","x-displayname":"Security Events ID","x-ves-proto-message":"ves.io.schema.waf.SecurityEventsId","properties":{"app_type":{"type":"string","description":" AppType configured on the vhost under which this WAF instance is running\n\nExample: ` \"blogging-app\"`","title":"AppType","x-displayname":"AppType","x-ves-example":"blogging-app"},"bot_name":{"type":"string","description":" Name of the Bot associated with the waf rule\n\nExample: ` \"whatweb\"`","title":"Bot Name","x-displayname":"Bot Name","x-ves-example":"whatweb"},"bot_type":{"type":"string","description":" Type of Bot (crawler, scanner, script)\n\nExample: ` \"scanner\"`","title":"Bot Type","x-displayname":"Bot Type","x-ves-example":"scanner"},"instance":{"type":"string","description":" Region from which the client's accesses caused WAF metrics to be generated\n\nExample: ` \"India\"`","title":"Instance","x-displayname":"Instance","x-ves-example":"India"},"namespace":{"type":"string","description":" Namespace in which this WAF instance is running\n\nExample: ` \"blogging-app-namespace-1\"`","title":"Namespace","x-displayname":"Namespace","x-ves-example":"blogging-app-namespace-1"},"service":{"type":"string","description":" Service for which this WAF instance is reporting the metrics\n\nExample: ` \"N:greatblogs-ce\"`","title":"Service","x-displayname":"Service","x-ves-example":"N:greatblogs-ce"},"site":{"type":"string","description":" Site from which this WAF instance is reporting the metrics\n\nExample: ` \"greatblogs-ce\"`","title":"Site","x-displayname":"Site","x-ves-example":"greatblogs-ce"},"virtual_host":{"type":"string","description":" Virtual host under which this WAF instance is running\n\nExample: ` \"VS:greatblogs-vhost\"`","title":"Virtual Host","x-displayname":"Virtual Host","x-ves-example":"VS:greatblogs-vhost"},"waf_instance_id":{"type":"string","description":" WAF instance ID\n\nExample: ` \"blogging-app-namespace-1:generated-waf-rules-greatblogs-waf\"`","title":"WAF Instance ID","x-displayname":"WAF Instance ID","x-ves-example":"blogging-app-namespace-1:generated-waf-rules-greatblogs-waf"},"waf_mode":{"type":"string","description":" Block or AlertOnly\n\nExample: ` \"Block\"`","title":"WAF Mode","x-displayname":"WAF Mode","x-ves-example":"Block"}}}}}}