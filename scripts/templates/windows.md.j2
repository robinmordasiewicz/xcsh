# Windows

Install f5xcctl on Windows using PowerShell.

## Quick Install

Download and extract the latest release:

=== "PowerShell (amd64)"

    ```powershell
    # Download latest release
    $version = "{{ version or 'X.Y.Z' }}"
    $url = "https://github.com/robinmordasiewicz/f5xcctl/releases/download/v$version/f5xcctl_${version}_windows_amd64.zip"
    Invoke-WebRequest -Uri $url -OutFile f5xcctl.zip

    # Extract to installation directory
    $installDir = "$env:LOCALAPPDATA\Programs\f5xcctl"
    New-Item -ItemType Directory -Force -Path $installDir | Out-Null
    Expand-Archive -Path f5xcctl.zip -DestinationPath $installDir -Force

    # Add to PATH for current session
    $env:PATH = "$installDir;$env:PATH"

    # Verify installation
    f5xcctl version
    ```

=== "PowerShell (arm64)"

    ```powershell
    # Download latest release
    $version = "{{ version or 'X.Y.Z' }}"
    $url = "https://github.com/robinmordasiewicz/f5xcctl/releases/download/v$version/f5xcctl_${version}_windows_arm64.zip"
    Invoke-WebRequest -Uri $url -OutFile f5xcctl.zip

    # Extract to installation directory
    $installDir = "$env:LOCALAPPDATA\Programs\f5xcctl"
    New-Item -ItemType Directory -Force -Path $installDir | Out-Null
    Expand-Archive -Path f5xcctl.zip -DestinationPath $installDir -Force

    # Add to PATH for current session
    $env:PATH = "$installDir;$env:PATH"

    # Verify installation
    f5xcctl version
    ```

{% if install_output %}
**Example output:**

```text
{{ install_output }}
```

{% if generation_date %}
*Output captured on {{ generation_date }}*
{% endif %}
{% endif %}

## Permanent PATH Configuration

To make f5xcctl available in all PowerShell sessions, add it to your user PATH:

```powershell
# Add to user PATH permanently
$installDir = "$env:LOCALAPPDATA\Programs\f5xcctl"
$currentPath = [Environment]::GetEnvironmentVariable("PATH", "User")
if ($currentPath -notlike "*$installDir*") {
    [Environment]::SetEnvironmentVariable("PATH", "$installDir;$currentPath", "User")
    Write-Host "Added $installDir to user PATH. Restart your terminal to apply."
}
```

## Manual Download

Alternatively, download directly from GitHub:

1. Visit [GitHub Releases](https://github.com/robinmordasiewicz/f5xcctl/releases/latest)
2. Download `f5xcctl_{{ version or 'X.Y.Z' }}_windows_amd64.zip` (or `arm64` for ARM processors)
3. Extract to a directory of your choice
4. Add the directory to your PATH

## Verify Installation

After installation, verify f5xcctl is working:

```powershell
f5xcctl version
```

{% if version and commit and built %}
Expected output:

```text
f5xcctl version {{ version }}
  commit:   {{ commit }}
  built:    {{ built }}
  go:       {{ go_version if go_version else "go1.23.x" }}
  platform: {{ platform if platform else "windows/amd64" }}
```
{% endif %}

## Shell Completion

Enable PowerShell tab completion:

```powershell
# Load completions for current session
f5xcctl completion powershell | Out-String | Invoke-Expression

# Add to PowerShell profile for all sessions
f5xcctl completion powershell >> $PROFILE
```

!!! note "PowerShell Profile"
    If `$PROFILE` doesn't exist, create it first:
    ```powershell
    New-Item -ItemType File -Force -Path $PROFILE
    ```

## Upgrade

To upgrade to a newer version:

```powershell
# Download and extract new version (same as install)
$version = "NEW_VERSION"
$url = "https://github.com/robinmordasiewicz/f5xcctl/releases/download/v$version/f5xcctl_${version}_windows_amd64.zip"
Invoke-WebRequest -Uri $url -OutFile f5xcctl.zip
Expand-Archive -Path f5xcctl.zip -DestinationPath "$env:LOCALAPPDATA\Programs\f5xcctl" -Force
```

## Uninstall

Remove f5xcctl from your system:

```powershell
# Remove installation directory
Remove-Item -Recurse -Force "$env:LOCALAPPDATA\Programs\f5xcctl"

# Remove from user PATH
$installDir = "$env:LOCALAPPDATA\Programs\f5xcctl"
$currentPath = [Environment]::GetEnvironmentVariable("PATH", "User")
$newPath = ($currentPath -split ';' | Where-Object { $_ -ne $installDir }) -join ';'
[Environment]::SetEnvironmentVariable("PATH", $newPath, "User")

# Remove completion from profile (if added)
# Edit $PROFILE and remove the f5xcctl completion line
```

## Troubleshooting

### "f5xcctl is not recognized"

Ensure the installation directory is in your PATH:

```powershell
$env:PATH -split ';' | Select-String "f5xcctl"
```

If not found, add it manually or restart your terminal after permanent PATH configuration.

### Execution Policy Error

If you get an execution policy error when loading completions:

```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```
