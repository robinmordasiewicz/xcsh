# Windows

Install xcsh on Windows using PowerShell.

## Quick Install

Download and extract the latest release:

=== "PowerShell (x64)"

    ```powershell
    # Download latest release
    $version = "{{ version or 'X.Y.Z' }}"
    $url = "https://github.com/robinmordasiewicz/xcsh/releases/download/v$version/xcsh-win-x64.exe"

    # Create installation directory
    $installDir = "$env:LOCALAPPDATA\Programs\xcsh"
    New-Item -ItemType Directory -Force -Path $installDir | Out-Null

    # Download executable
    Invoke-WebRequest -Uri $url -OutFile "$installDir\xcsh.exe"

    # Add to PATH for current session
    $env:PATH = "$installDir;$env:PATH"

    # Verify installation
    xcsh --version
    ```

=== "PowerShell (arm64)"

    ```powershell
    # Download latest release
    $version = "{{ version or 'X.Y.Z' }}"
    $url = "https://github.com/robinmordasiewicz/xcsh/releases/download/v$version/xcsh-win-arm64.exe"

    # Create installation directory
    $installDir = "$env:LOCALAPPDATA\Programs\xcsh"
    New-Item -ItemType Directory -Force -Path $installDir | Out-Null

    # Download executable
    Invoke-WebRequest -Uri $url -OutFile "$installDir\xcsh.exe"

    # Add to PATH for current session
    $env:PATH = "$installDir;$env:PATH"

    # Verify installation
    xcsh --version
    ```

{% if install_output %}
**Example output:**

```text
{{ install_output }}
```

{% if generation_date %}
*Output captured on {{ generation_date }}*
{% endif %}
{% endif %}

## Permanent PATH Configuration

To make xcsh available in all PowerShell sessions, add it to your user PATH:

```powershell
# Add to user PATH permanently
$installDir = "$env:LOCALAPPDATA\Programs\xcsh"
$currentPath = [Environment]::GetEnvironmentVariable("PATH", "User")
if ($currentPath -notlike "*$installDir*") {
    [Environment]::SetEnvironmentVariable("PATH", "$installDir;$currentPath", "User")
    Write-Host "Added $installDir to user PATH. Restart your terminal to apply."
}
```

## Manual Download

Alternatively, download directly from GitHub:

1. Visit [GitHub Releases](https://github.com/robinmordasiewicz/xcsh/releases/latest)
2. Download `xcsh-win-x64.exe` (or `xcsh-win-arm64.exe` for ARM processors)
3. Rename to `xcsh.exe` and place in a directory of your choice
4. Add the directory to your PATH

## Verify Installation

After installation, verify xcsh is working:

```powershell
xcsh --version
```

{% if version %}
Expected output:

```text
{{ version }}
```
{% endif %}

## Shell Completion

Enable PowerShell tab completion:

```powershell
# Load completions for current session
xcsh completion powershell | Out-String | Invoke-Expression

# Add to PowerShell profile for all sessions
xcsh completion powershell >> $PROFILE
```

!!! note "PowerShell Profile"
    If `$PROFILE` doesn't exist, create it first:
    ```powershell
    New-Item -ItemType File -Force -Path $PROFILE
    ```

## Upgrade

To upgrade to a newer version:

```powershell
# Download new version (same as install)
$version = "NEW_VERSION"
$url = "https://github.com/robinmordasiewicz/xcsh/releases/download/v$version/xcsh-win-x64.exe"
Invoke-WebRequest -Uri $url -OutFile "$env:LOCALAPPDATA\Programs\xcsh\xcsh.exe"
```

## Uninstall

Remove xcsh from your system:

```powershell
# Remove installation directory
Remove-Item -Recurse -Force "$env:LOCALAPPDATA\Programs\xcsh"

# Remove from user PATH
$installDir = "$env:LOCALAPPDATA\Programs\xcsh"
$currentPath = [Environment]::GetEnvironmentVariable("PATH", "User")
$newPath = ($currentPath -split ';' | Where-Object { $_ -ne $installDir }) -join ';'
[Environment]::SetEnvironmentVariable("PATH", $newPath, "User")

# Remove completion from profile (if added)
# Edit $PROFILE and remove the xcsh completion line
```

## Troubleshooting

### "xcsh is not recognized"

Ensure the installation directory is in your PATH:

```powershell
$env:PATH -split ';' | Select-String "xcsh"
```

If not found, add it manually or restart your terminal after permanent PATH configuration.

### Execution Policy Error

If you get an execution policy error when loading completions:

```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```
